
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mission Locale â€“ Jeu</title>

<style>
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:#eef7f8;
  text-align:center;
}

#menu{
  position:fixed;
  inset:0;
  background:#eef7f8;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:10;
}

.menu-box{
  background:white;
  padding:20px;
  border-radius:12px;
  max-width:400px;
  box-shadow:0 10px 30px rgba(0,0,0,.2);
}

button{
  padding:12px 20px;
  font-size:16px;
  background:#0f7780;
  color:white;
  border:none;
  border-radius:8px;
  cursor:pointer;
}

canvas{
  background:white;
  display:block;
  margin:20px auto;
  border-radius:10px;
}

#hud{
  font-weight:bold;
}
</style>
</head>

<body>

<div id="menu">
  <div class="menu-box">
    <h2>ðŸŽ¯ Parcours Pro â€“ Mission Locale</h2>
    <p>
      Clique ou appuie sur ESPACE pour sauter.<br><br>
      Si tu touches un obstacle, une question apparaÃ®t.<br>
      Mauvaise rÃ©ponse = score Ã  0.
    </p>
    <button id="play">DÃ©marrer</button>
  </div>
</div>

<canvas id="game" width="800" height="300"></canvas>

<div id="hud">
  Score : <span id="score">0</span> |
  Niveau : <span id="level">1</span>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let playing=false;
let score=0;
let level=1;
let speed=4;

const player={x:80,y:220,r:15,vy:0,jump:false};
let obstacles=[];

const questions=[
 {q:"Que doit-on apporter Ã  un entretien ?",r:["Un CV","Une console"],c:0},
 {q:"Arriver Ã  lâ€™heure signifie ?",r:["10 min avant","En retard"],c:0},
 {q:"Ã€ quoi sert un stage ?",r:["DÃ©couvrir un mÃ©tier","Jouer"],c:0}
];

function jump(){
  if(!player.jump){
    player.vy=-14;
    player.jump=true;
  }
}

function spawnObstacle(){
  obstacles.push({x:canvas.width,y:230,w:30,h:30});
}

function showQuiz(){
  playing=false;
  const q=questions[Math.floor(Math.random()*questions.length)];
  const good=confirm(q.q+"\n\nOK = "+q.r[0]+"\nAnnuler = "+q.r[1]);
  if(!good) score=0;
  playing=true;
}

function loop(){
  if(!playing) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  // sol
  ctx.fillStyle="#ddd";
  ctx.fillRect(0,245,canvas.width,5);

  // joueur
  player.vy+=0.8;
  player.y+=player.vy;
  if(player.y>220){player.y=220;player.vy=0;player.jump=false;}

  ctx.beginPath();
  ctx.arc(player.x,player.y,player.r,0,Math.PI*2);
  ctx.fillStyle="#0f7780";
  ctx.fill();

  // obstacles
  if(Math.random()<0.02) spawnObstacle();

  obstacles.forEach(o=>{
    o.x-=speed;
    ctx.fillStyle="#333";
    ctx.fillRect(o.x,o.y,o.w,o.h);

    if(
      o.x < player.x+player.r &&
      o.x+o.w > player.x-player.r &&
      player.y+player.r > o.y
    ){
      obstacles=[];
      showQuiz();
    }
  });

  obstacles = obstacles.filter(o=>o.x>-40);

  score++;
  if(score%400===0){level++;speed+=0.5;}

  document.getElementById("score").textContent=score;
  document.getElementById("level").textContent=level;

  requestAnimationFrame(loop);
}

document.getElementById("play").onclick=()=>{
  document.getElementById("menu").style.display="none";
  playing=true;
  loop();
};

document.addEventListener("keydown",e=>{
  if(e.code==="Space") jump();
});

canvas.addEventListener("click",jump);
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MLE Runner</title>

<style>
body{
  margin:0;
  background:#0d47a1;
  font-family:Arial,Helvetica,sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
#container{position:relative;}
canvas{
  background:linear-gradient(#ffffff,#e3f2fd);
  border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.35);
}
.overlay{
  position:absolute;
  inset:0;
  background:rgba(255,255,255,.95);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  color:#0d47a1;
  border-radius:14px;
}
button{
  margin-top:15px;
  padding:12px 24px;
  font-size:16px;
  border:none;
  border-radius:8px;
  background:#ffca28;
  cursor:pointer;
}
button:hover{background:#ffc107;}
.qcm button{width:100%;margin:6px 0;}
</style>
 
</head>

<body>
<div id="container">
  <div id="footer">
  La Mission Locale vous souhaite un super jeu !
</div>

  <canvas id="game" width="800" height="400"></canvas>

  <div id="start" class="overlay">
    <h2>Runner Mission Locale</h2>
    <p>Sauter pour éviter les obstacles</p>
    <button id="startBtn">Démarrer</button>
  </div>

  <div id="question" class="overlay" style="display:none"></div>
</div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let state='menu';
let score=0, level=1, speed=4, immunity=0;

const groundY=300;
const player={x:120,y:groundY,r:22,vy:0};
let obstacles=[];
let lastObstacleX=0;

const MAX_OBSTACLES=4;
const BASE_GAP=170;

const questions=[
 {q:'À quoi sert un CV ?',c:['Présenter ses compétences','Dormir','Jouer'],a:0},
 {q:'Un entretien sert principalement à ?',c:['Évaluer un candidat','Se reposer','Regarder un film'],a:0},
 {q:'La Mission Locale accompagne surtout les ?',c:['Jeunes','Entreprises','Enfants'],a:0},
 {q:'Qu’est-ce qu’une formation ?',c:['Un apprentissage','Un loisir','Un jeu'],a:0},
 {q:'Pourquoi préparer un entretien ?',c:['Pour réussir','Pour s’amuser','Pour dormir'],a:0},
 {q:'Le CV doit être ?',c:['Clair et structuré','Très long','Illisible'],a:0},
 {q:'La ponctualité est ?',c:['Importante','Inutile','Interdite'],a:0}   { q:"Comment adapter son CV à une offre ?", a:["Mettre en avant les compétences demandées","Envoyer le même CV","Changer juste la police"], correct:0, points:35 },
  { q:"Qu'est-ce qu'une lettre de motivation ?", a:["Un texte adapté à l'offre","Un CV plus long","Une liste de notes personnelles"], correct:0, points:25 },
  { q:"Où trouver des offres ?", a:["Sites d'emploi","Sur la Lune"], correct:0, points:20 },
  { q:"Quel comportement éviter en entretien ?", a:["Regarder son téléphone","Écouter le recruteur","Demander des précisions"], correct:0, points:30 },
  { q:"Qu'est-ce qu'un \"stage\" ?", a:["Une période d'apprentissage en entreprise","Un travail permanent","Un abonnement"], correct:0, points:20 },
  { q:"Pourquoi relancer une candidature ?", a:["Montrer son intérêt","Manquer d'organisation","Crier"], correct:0, points:25 },
  { q:"Comment se présenter ?", a:["Nom + objectif professionnel bref","Raconter un long épisode","Chanter"], correct:0, points:30 },
  { q:"Qu'est-ce qu'un bon CV ?", a:["Clairement structuré","Brouillon","Sans contact"], correct:0, points:35 },
  { q:"Quelle information NE doit PAS figurer ?", a:["Informations médicales sensibles","Compétences","Contact"], correct:0, points:30 },
  { q:"Que signifie \"références\" dans un CV ?", a:["Personnes pouvant témoigner de vous","Des références bibliographiques","Un mystère"], correct:0, points:20 },
  { q:"Qu'est-ce qu'une compétence transférable ?", a:["Capacité utile dans plusieurs emplois","Un seul logiciel","Un diplôme précis"], correct:0, points:30 },
  { q:"Que faire si on ne sait pas répondre en entretien ?", a:["Admettre et proposer comment trouver la réponse","Inventer une fausse réponse","Ignorer"], correct:0, points:40 },
  { q:"Quel ton adopter en entretien ?", a:["Professionnel et cordial","Hautain","Trop familier"], correct:0, points:30 },
  { q:"Comment montrer sa motivation ?", a:["Par des exemples concrets","Dire \"je suis motivé\" sans preuve","Ne rien faire"], correct:0, points:35 },
  { q:"Qu'est-ce qu'une lettre d'accompagnement ?", a:["Un texte pour contextualiser le CV","Un CV détourné","Un document inutile"], correct:0, points:25 },
  { q:"Pourquoi soigner son profil en ligne ?", a:["Les recruteurs regardent souvent","Personne ne regarde","C'est interdit"], correct:0, points:25 },
  { q:"Citer une soft skill importante ?", a:["Capacité d'écoute","Savoir tout faire","Ignorance"], correct:0, points:20 },
  { q:"Que faire en cas de retard ?", a:["Prévenir et s'excuser","Rester silencieux","Ignorer"], correct:0, points:20 },
  { q:"Quelle information est utile pour un recruteur ?", a:["Expériences récentes et pertinentes","Vos secrets","Informations bancaires"], correct:0, points:30 },
  { q:"Qu'est-ce que la ponctualité ?", a:["Arriver à l'heure","Arriver quand on veut","Partir tôt"], correct:0, points:15 },
  { q:"Pourquoi personnaliser sa candidature ?", a:["Montrer l'adéquation avec l'offre","Gagner du temps","Faire n'importe quoi"], correct:0, points:25 },
  { q:"Que faire avec un trou dans le CV ?", a:["Expliquer brièvement en valorisant","Tout cacher","Mentir"], correct:0, points:20 },
  { q:"Quel document joindre ?", a:["CV + lettre adaptée","Rien","Tout ce qu'on a"], correct:0, points:20 },
  { q:"Où demander de l'aide ?", a:["Mission Locale / Pôle emploi / réseau","Personne","La rue"], correct:0, points:20 },
  { q:"Comment se former ?", a:["Par des formations, des MOOC, des stages","Rien","Regarder la télé"], correct:0, points:25 },
  { q:"Que montre une bonne attitude ?", a:["Curiosité et respect","Arrogance","Indifférence"], correct:0, points:30 },
  { q:"Pourquoi relire son CV ?", a:["Éviter les fautes et les incohérences","Pour le style fantaisiste","Pour l'oublier"], correct:0, points:20 },
  { q:"Que signifie \"candidature spontanée\" ?", a:["Envoyer son CV sans offre précise","Attendre une offre","Appeler en criant"], correct:0, points:25 },
  { q:"Comment préparer un entretien ?", a:["Se renseigner sur l'entreprise","Y aller sans préparation","Ignorer l'entreprise"], correct:0, points:30 },
  { q:"Quel est l'objectif d'une lettre ?", a:["Montrer l'adéquation avec l'offre","Remplir un espace","Raconter sa vie"], correct:0, points:20 },
  { q:"Pourquoi valoriser un stage ?", a:["Montrer des compétences réelles","Le cacher","Ne rien dire"], correct:0, points:20 },
  { q:"Qu'est-ce qu'une alternance ?", a:["Formation en entreprise + école","Vacances prolongées","Un emploi permanent"], correct:0, points:20 },
  { q:"Que faire après un entretien ?", a:["Remercier et relancer si besoin","Tout oublier","Attendre une semaine sans rien faire"], correct:0, points:20 },
  { q:"Quel est un bon comportement en équipe ?", a:["Partager l'information","Tout garder pour soi","S'opposer systématiquement"], correct:0, points:30 },
  { q:"Pourquoi être honnête ?", a:["La confiance facilite l'embauche","On ne sait pas","C'est inutile"], correct:0, points:30 },
  { q:"Que chercher dans une offre ?", a:["Mots-clés, compétences et missions","Juste le salaire","Rien"], correct:0, points:25 },
  { q:"Que fait un conseiller Mission Locale ?", a:["Aide, orientation, formations","Rien","Décore des bureaux"], correct:0, points:20 }
]
];

let lastQuestions=[];

document.getElementById('startBtn').onclick=()=>{
  document.getElementById('start').style.display='none';
  resetGame();
  state='play';
};

function resetGame(){
  score=0; level=1; speed=4;
  obstacles=[];
  immunity=120;
  lastQuestions=[];
  player.y=groundY; player.vy=0;
}

function jump(){
  if(state==='play' && player.y>=groundY){
    player.vy=-12;
  }
}
window.addEventListener('keydown',e=>{if(e.code==='Space') jump();});
canvas.addEventListener('click',jump);

function spawnObstacle(){
  const air=level>=3 && Math.random()<0.3;
  obstacles.push({
    x:canvas.width+30,
    y:air ? groundY-80-Math.random()*40 : groundY+player.r-10,
    w:26,h:40
  });
  lastObstacleX=canvas.width+30;
}

function showQuestion(){
  state='question';

  let available=questions.filter(q=>!lastQuestions.includes(q.q));
  if(!available.length){
    lastQuestions=[];
    available=[...questions];
  }
  const q=available[Math.floor(Math.random()*available.length)];
  lastQuestions.push(q.q);
  if(lastQuestions.length>3) lastQuestions.shift();

  const box=document.getElementById('question');
  box.innerHTML=`<h3>${q.q}</h3><div class="qcm"></div>`;
  box.style.display='flex';

  q.c.forEach((txt,i)=>{
    const b=document.createElement('button');
    b.textContent=txt;
    b.onclick=()=>{
      box.style.display='none';
      if(i===q.a){
        obstacles=[];
        immunity=120;
        state='play';
      }else{
        state='menu';
        document.getElementById('start').style.display='flex';
      }
    };
    box.querySelector('.qcm').appendChild(b);
  });
}

function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(state==='play'){
    player.vy+=0.6;
    player.y+=player.vy;
    if(player.y>groundY){player.y=groundY;player.vy=0;}

    const gap=BASE_GAP+level*10;
    if(
      obstacles.length<MAX_OBSTACLES &&
      (obstacles.length===0 || canvas.width-lastObstacleX>gap) &&
      Math.random()<0.015+level*0.001
    ){
      spawnObstacle();
    }

    obstacles.forEach(o=>{
      o.x-=speed;
      ctx.fillStyle=immunity>0?'#81c784':'#e53935';
      ctx.fillRect(o.x,o.y,o.w,o.h);

      const cx=Math.max(o.x,Math.min(player.x,o.x+o.w));
      const cy=Math.max(o.y,Math.min(player.y,o.y+o.h));
      const dx=player.x-cx, dy=player.y-cy;
      if(immunity<=0 && dx*dx+dy*dy<player.r*player.r){
        showQuestion();
      }
    });

    obstacles=obstacles.filter(o=>o.x+o.w>0);
    score++;

    if(score%400===0){
      level++;
      speed+=0.4;
    }
    if(immunity>0) immunity--;
  }

  ctx.beginPath();
  ctx.arc(player.x,player.y,player.r,0,Math.PI*2);
  ctx.fillStyle='#ffb300';
  ctx.fill();
  ctx.strokeStyle='#1565c0';
  ctx.lineWidth=4;
  ctx.stroke();
  
ctx.fillStyle = '#0d47a1';
ctx.font = '12px Arial';
ctx.textAlign = 'center';
ctx.textBaseline = 'middle';
ctx.fillText('MLE', player.x, player.y);

  ctx.fillStyle='#0d47a1';
  ctx.font='14px Arial';
  ctx.fillText('Score : '+score,10,20);
  ctx.fillText('Niveau : '+level,10,40);
  if(immunity>0) ctx.fillText('Immunité',10,60);

  requestAnimationFrame(loop);
}

requestAnimationFrame(loop);
</script>
</body>
</html>


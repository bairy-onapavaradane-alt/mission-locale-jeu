<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MLE Runner</title>

<style>
body{
  margin:0;
  background:#0d47a1;
  font-family:Arial,Helvetica,sans-serif;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-height:100vh;
}

#container{
  position:relative;
}

canvas{
  background:linear-gradient(#ffffff,#e3f2fd);
  border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.35);
}

.overlay{
  position:absolute;
  inset:0;
  background:rgba(255,255,255,.95);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  color:#0d47a1;
  border-radius:14px;
}

button{
  margin-top:15px;
  padding:12px 24px;
  font-size:16px;
  border:none;
  border-radius:8px;
  background:#ffca28;
  cursor:pointer;
}
button:hover{background:#ffc107;}

.qcm button{
  width:100%;
  margin:6px 0;
}

#footer{
  margin-top:12px;
  text-align:center;
  color:white;
  font-size:14px;
  font-weight:bold;
  opacity:0.9;
}
</style>
</head>

<body>

<div id="container">
  <canvas id="game" width="800" height="450"></canvas>

  <div id="start" class="overlay">
    <h2>Runner Mission Locale</h2>
    <p>Sauter pour éviter les obstacles</p>
    <p>Objectif : battre ton score</p>
    <button id="startBtn">Démarrer</button>
  </div>

  <div id="question" class="overlay" style="display:none"></div>
</div>

<div id="footer">
  La Mission Locale est vous souhaite un super jeu !
</div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let state = 'menu';
let score = 0;
let level = 1;
let speed = 4;
let immunity = 0;

const groundY = 340;

const player = { x:120, y:groundY, r:22, vy:0 };
let obstacles = [];
let lastObstacleX = 0;

const MAX_OBSTACLES = 4;
const BASE_GAP = 180;

// QUESTIONS (enrichies et variées)
const questions = [
 {q:'À quoi sert un CV ?',c:['Présenter ses compétences','Jouer','Dormir'],a:0},
 {q:'Pourquoi préparer un entretien ?',c:['Pour réussir','Pour perdre du temps','Pour dormir'],a:0},
 {q:'La Mission Locale accompagne surtout ?',c:['Les jeunes','Les enfants','Les retraités'],a:0},
 {q:'Un entretien permet de ?',c:['Évaluer un candidat','Regarder un film','Se reposer'],a:0},
 {q:'Le CV doit être ?',c:['Clair et structuré','Très long','Illisible'],a:0},
 {q:'La ponctualité est ?',c:['Importante','Optionnelle','Interdite'],a:0},
 {q:'Une formation sert à ?',c:['Apprendre','Se distraire','Rien faire'],a:0},
 {q:'Un projet professionnel permet de ?',c:['Définir son avenir','Perdre du temps','Éviter le travail'],a:0},
 {q:'Avant un entretien, il faut ?',c:['Se préparer','Improviser','Dormir'],a:0},
 {q:'La tenue en entretien doit être ?',c:['Adaptée','N’importe laquelle','Sale'],a:0}
];

let lastQuestions = [];

document.getElementById('startBtn').onclick = () => {
  document.getElementById('start').style.display='none';
  resetGame();
  state='play';
};

function resetGame(){
  score=0;
  level=1;
  speed=4;
  obstacles=[];
  player.y=groundY;
  player.vy=0;
  immunity=120;
  lastQuestions=[];
}

function jump(){
  if(state==='play' && player.y>=groundY){
    player.vy=-12;
  }
}
window.addEventListener('keydown',e=>{if(e.code==='Space') jump();});
canvas.addEventListener('click',jump);

function spawnObstacle(){
  const air = level>=3 && Math.random()<0.3;
  obstacles.push({
    x:canvas.width+30,
    y:air ? groundY-90-Math.random()*40 : groundY+player.r-10,
    w:26,
    h:40
  });
  lastObstacleX = canvas.width+30;
}

function showQuestion(){
  state='question';

  let available = questions.filter(q=>!lastQuestions.includes(q.q));
  if(available.length===0){
    lastQuestions=[];
    available=[...questions];
  }

  const q = available[Math.floor(Math.random()*available.length)];
  lastQuestions.push(q.q);
  if(lastQuestions.length>3) lastQuestions.shift();

  const box=document.getElementById('question');
  box.innerHTML=`<h3>${q.q}</h3><div class="qcm"></div>`;
  box.style.display='flex';

  q.c.forEach((txt,i)=>{
    const b=document.createElement('button');
    b.textContent=txt;
    b.onclick=()=>{
      box.style.display='none';
      if(i===q.a){
        obstacles=[];
        immunity=120;
        state='play';
      }else{
        state='menu';
        document.getElementById('start').style.display='flex';
      }
    };
    box.querySelector('.qcm').appendChild(b);
  });
}

function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(state==='play'){
    player.vy+=0.6;

</script>
</body>
</html>


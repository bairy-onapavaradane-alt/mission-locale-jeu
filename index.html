<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MLE Runner</title>

<style>
/* ================== DESKTOP (COMME AVANT) ================== */
body{
  margin:0;
  background:#0d47a1;
  font-family:Arial,Helvetica,sans-serif;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
}

#container{
  position:relative;
}

canvas{
  width:800px;
  height:450px;
  background:linear-gradient(#ffffff,#e3f2fd);
  border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.35);
}

.overlay{
  position:absolute;
  inset:0;
  background:rgba(255,255,255,.95);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  color:#0d47a1;
  border-radius:14px;
  z-index:5;
}

button{
  margin-top:15px;
  padding:12px 24px;
  font-size:16px;
  border:none;
  border-radius:8px;
  background:#ffca28;
  cursor:pointer;
}
button:hover{background:#ffc107;}
.qcm button{width:100%;margin:6px 0;}

#footer{
  margin-top:12px;
  color:white;
  font-size:14px;
  font-weight:bold;
  opacity:0.9;
}

/* ================== MOBILE UNIQUEMENT ================== */
@media (max-width: 900px){
  body{
    height:auto;
    padding:10px 0;
  }

  canvas{
    width:95vw;
    height:auto;
  }
}

/* MESSAGE ORIENTATION */
#rotateMsg{
  position:fixed;
  inset:0;
  background:#0d47a1;
  color:white;
  display:none;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:30px;
  z-index:20;
  font-size:18px;
}
</style>
</head>

<body>

<div id="rotateMsg">
  ðŸ“±ðŸ”„<br><br>
  Ce jeu se joue uniquement en <b>mode paysage</b>.<br>
  Tourne ton tÃ©lÃ©phone pour jouer ðŸ™‚
</div>

<div id="container">
  <canvas id="game" width="800" height="450"></canvas>

  <div id="start" class="overlay">
    <h2>Runner Mission Locale</h2>
    <p>Sauter pour Ã©viter les obstacles</p>
    <button id="startBtn">DÃ©marrer</button>
  </div>

  <div id="question" class="overlay" style="display:none"></div>
</div>

<div id="footer">
  La Mission Locale vous souhaite un super jeu !
</div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const rotateMsg = document.getElementById('rotateMsg');

let state='menu';
let pausedByOrientation=false;

let score=0, level=1, speed=4, immunity=0;
const groundY=340;
const player={x:120,y:groundY,r:22,vy:0};

let obstacles=[], lastObstacleX=0;
const MAX_OBSTACLES=4;
const BASE_GAP=180;

const questions=[
  {
    q: "Que faut-il absolument mettre en haut dâ€™un CV ?",
    a: [
      "Nom, prÃ©nom et coordonnÃ©es",
      "Une citation personnelle",
      "Ses loisirs dÃ©taillÃ©s"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quelle est la durÃ©e idÃ©ale pour un CV ciblÃ© ?",
    a: [
      "Une page claire et synthÃ©tique",
      "Plusieurs pages dÃ©taillÃ©es",
      "Autant de pages que dâ€™expÃ©riences"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Que signifie le terme Â« soft skill Â» ?",
    a: [
      "CompÃ©tence liÃ©e au comportement et au savoir-Ãªtre",
      "Outil informatique",
      "Certification officielle"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Que faire aprÃ¨s avoir envoyÃ© une candidature ?",
    a: [
      "Relancer de maniÃ¨re polie aprÃ¨s quelques jours",
      "Supprimer le contact",
      "Envoyer des messages tous les jours"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Comment adapter son CV Ã  une offre dâ€™emploi ?",
    a: [
      "Mettre en avant les compÃ©tences demandÃ©es",
      "Utiliser un CV gÃ©nÃ©rique",
      "Changer uniquement les couleurs"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quâ€™est-ce quâ€™une lettre de motivation ?",
    a: [
      "Un texte personnalisÃ© expliquant son intÃ©rÃªt pour le poste",
      "Un rÃ©sumÃ© du CV",
      "Une lettre pour se prÃ©senter sans lien avec lâ€™offre"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quel comportement faut-il Ã©viter en entretien ?",
    a: [
      "Consulter son tÃ©lÃ©phone",
      "Ã‰couter attentivement",
      "Poser des questions pertinentes"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quâ€™est-ce quâ€™un stage ?",
    a: [
      "Une expÃ©rience professionnelle encadrÃ©e pour apprendre",
      "Un emploi Ã  vie",
      "Un loisir"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Pourquoi relancer une candidature ?",
    a: [
      "Montrer sa motivation et son sÃ©rieux",
      "Mettre la pression au recruteur",
      "Exprimer son mÃ©contentement"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quâ€™est-ce quâ€™un bon CV ?",
    a: [
      "Un document clair, lisible et bien structurÃ©",
      "Un texte long sans organisation",
      "Un document sans coordonnÃ©es"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quelle information ne doit pas figurer sur un CV ?",
    a: [
      "Des informations mÃ©dicales sensibles",
      "Les compÃ©tences",
      "Les expÃ©riences"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Que faire si lâ€™on ne sait pas rÃ©pondre Ã  une question en entretien ?",
    a: [
      "Lâ€™admettre et expliquer comment chercher la rÃ©ponse",
      "Inventer une rÃ©ponse",
      "Changer de sujet"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quel ton adopter lors dâ€™un entretien ?",
    a: [
      "Professionnel et respectueux",
      "Froid et distant",
      "Trop familier"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Comment prouver sa motivation ?",
    a: [
      "Donner des exemples concrets",
      "RÃ©pÃ©ter quâ€™on est motivÃ©",
      "Ne rien expliquer"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quâ€™est-ce quâ€™une lettre dâ€™accompagnement ?",
    a: [
      "Un texte expliquant et complÃ©tant le CV",
      "Un CV modifiÃ©",
      "Un document inutile"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Pourquoi soigner son profil en ligne ?",
    a: [
      "Parce que les recruteurs le consultent souvent",
      "Parce que câ€™est obligatoire",
      "Parce que personne ne le voit"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quelle soft skill est importante ?",
    a: [
      "La capacitÃ© dâ€™Ã©coute",
      "La prÃ©tention",
      "Le refus de coopÃ©rer"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Que faire en cas de retard Ã  un entretien ?",
    a: [
      "PrÃ©venir rapidement et sâ€™excuser",
      "Ne rien dire",
      "Annuler sans explication"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quelle information est utile pour un recruteur ?",
    a: [
      "Les expÃ©riences rÃ©centes et pertinentes",
      "Les informations bancaires",
      "Les opinions personnelles"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quâ€™est-ce que la ponctualitÃ© ?",
    a: [
      "Respecter les horaires",
      "Arriver quand on veut",
      "Partir avant lâ€™heure"
    ],
    correct: 0,
    points: 15
  },
  {
    q: "Pourquoi relire son CV avant de lâ€™envoyer ?",
    a: [
      "Ã‰viter les fautes et les erreurs",
      "Changer le contenu au hasard",
      "Ne rien corriger"
    ],
    correct: 0,
    points: 15
  },
  {
    q: "Comment bien prÃ©parer un entretien ?",
    a: [
      "Se renseigner sur lâ€™entreprise",
      "Improviser totalement",
      "Ignorer le poste"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quâ€™est-ce quâ€™une alternance ?",
    a: [
      "Une formation combinant Ã©cole et entreprise",
      "Une pause professionnelle",
      "Un emploi sans formation"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Quel est un bon comportement en Ã©quipe ?",
    a: [
      "Partager lâ€™information et coopÃ©rer",
      "Travailler seul systÃ©matiquement",
      "CrÃ©er des conflits"
    ],
    correct: 0,
    points: 20
  },
  {
    q: "Que faut-il analyser dans une offre dâ€™emploi ?",
    a: [
      "Les missions et les compÃ©tences demandÃ©es",
      "Uniquement le salaire",
      "Rien de prÃ©cis"
    ],
    correct: 0,
    points: 20
  }
]

let lastQuestions=[];

document.getElementById('startBtn').onclick=()=>{
  document.getElementById('start').style.display='none';
  resetGame();
  state='play';
};

function resetGame(){
  score=0; level=1; speed=4;
  obstacles=[]; immunity=120; lastQuestions=[];
  player.y=groundY; player.vy=0;
}

function jump(){
  if(state==='play' && !pausedByOrientation && player.y>=groundY){
    player.vy=-12;
  }
}
window.addEventListener('keydown',e=>{if(e.code==='Space') jump();});
canvas.addEventListener('click',jump);
canvas.addEventListener('touchstart',jump);

function spawnObstacle(){
  const air=level>=3 && Math.random()<0.3;
  obstacles.push({
    x:canvas.width+30,
    y:air?groundY-90-Math.random()*40:groundY+player.r-10,
    w:26,h:40
  });
  lastObstacleX=canvas.width+30;
}

function showQuestion(){
  state='question';
  let available=questions.filter(q=>!lastQuestions.includes(q.q));
  if(!available.length){lastQuestions=[];available=[...questions];}
  const q=available[Math.floor(Math.random()*available.length)];
  lastQuestions.push(q.q); if(lastQuestions.length>3) lastQuestions.shift();

  const box=document.getElementById('question');
  box.innerHTML=`<h3>${q.q}</h3><div class="qcm"></div>`;
  box.style.display='flex';

  q.c.forEach((txt,i)=>{
    const b=document.createElement('button');
    b.textContent=txt;
    b.onclick=()=>{
      box.style.display='none';
      if(i===q.a){obstacles=[];immunity=120;state='play';}
      else{state='menu';document.getElementById('start').style.display='flex';}
    };
    box.querySelector('.qcm').appendChild(b);
  });
}

/* ORIENTATION MOBILE UNIQUEMENT */
function checkOrientation(){
  if(window.innerWidth<900 && window.innerHeight>window.innerWidth){
    rotateMsg.style.display='flex';
    pausedByOrientation=true;
  }else{
    rotateMsg.style.display='none';
    pausedByOrientation=false;
  }
}
window.addEventListener('resize',checkOrientation);
checkOrientation();

function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(state==='play' && !pausedByOrientation){
    player.vy+=0.6;
    player.y+=player.vy;
    if(player.y>groundY){player.y=groundY;player.vy=0;}

    const gap=BASE_GAP+level*10;
    if(obstacles.length<MAX_OBSTACLES &&
       (obstacles.length===0||canvas.width-lastObstacleX>gap) &&
       Math.random()<0.015+level*0.001){
      spawnObstacle();
    }

    obstacles.forEach(o=>{
      o.x-=speed;
      ctx.fillStyle=immunity>0?'#81c784':'#e53935';
      ctx.fillRect(o.x,o.y,o.w,o.h);

      const cx=Math.max(o.x,Math.min(player.x,o.x+o.w));
      const cy=Math.max(o.y,Math.min(player.y,o.y+o.h));
      const dx=player.x-cx,dy=player.y-cy;
      if(immunity<=0 && dx*dx+dy*dy<player.r*player.r){
        showQuestion();
      }
    });

    obstacles=obstacles.filter(o=>o.x+o.w>0);
    score++; if(score%400===0){level++;speed+=0.4;}
    if(immunity>0) immunity--;
  }

  ctx.beginPath();
  ctx.arc(player.x,player.y,player.r,0,Math.PI*2);
  ctx.fillStyle='#ffb300'; ctx.fill();
  ctx.strokeStyle='#1565c0'; ctx.lineWidth=4; ctx.stroke();
  ctx.fillStyle='#0d47a1'; ctx.font='12px Arial';
  ctx.textAlign='center'; ctx.textBaseline='middle';
  ctx.fillText('MLE',player.x,player.y);

  ctx.textAlign='left'; ctx.font='14px Arial';
  ctx.fillText('Score : '+score,10,25);
  ctx.fillText('Niveau : '+level,10,45);
  if(immunity>0) ctx.fillText('ImmunitÃ©',10,65);

  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>

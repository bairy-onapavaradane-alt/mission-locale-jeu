<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MLE Runner – Mission Locale</title>
  <style>
    :root{
      --bleu:#1e88e5;
      --jaune:#fdd835;
      --rouge:#e53935;
      --blanc:#ffffff;
      --fond:#f5f7fb;
      --orange:#ffb74d;
    }
    *{box-sizing:border-box;font-family:Arial, Helvetica, sans-serif}
    body{
      margin:0;
      background:linear-gradient(180deg,#e3f2fd,#ffffff);
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
    }
    #gameContainer{
      width:100%;
      max-width:900px;
      background:var(--blanc);
      border-radius:16px;
      box-shadow:0 10px 30px rgba(0,0,0,0.1);
      overflow:hidden;
    }
    header{
      background:var(--bleu);
      color:white;
      padding:10px 16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:14px;
    }
    #score{font-weight:bold}
    #consigne{font-size:12px;opacity:0.9}
    canvas{display:block;background:var(--fond)}

    /* Écrans */
    .overlay{
      position:absolute;
      inset:0;
      background:rgba(255,255,255,0.95);
      display:flex;
      justify-content:center;
      align-items:center;
      padding:20px;
    }
    .box{
      max-width:600px;
      width:100%;
      background:white;
      border-radius:16px;
      padding:24px;
      box-shadow:0 8px 20px rgba(0,0,0,0.15);
      text-align:center;
    }
    .box h1{color:var(--bleu);margin-top:0}
    .box p{color:#333}
    button{
      background:var(--jaune);
      border:none;
      padding:12px 20px;
      border-radius:30px;
      font-size:16px;
      cursor:pointer;
      margin-top:12px;
    }
    button:hover{background:#ffeb3b}

    /* QCM */
    .answers{display:grid;grid-template-columns:1fr;gap:10px;margin-top:16px}
    .answers button{background:var(--bleu);color:white}
    .answers button:hover{background:#1565c0}

    /* Positionnement */
    #wrapper{position:relative}
  </style>
</head>
<body>
  <div id="gameContainer">
    <header>
      <div id="consigne">Saute pour éviter les obstacles – Objectif : battre ton score</div>
      <div id="score">Score : 0 | Niveau : 1</div>
    </header>
    <div id="wrapper">
      <canvas id="game" width="900" height="400"></canvas>

      <!-- Écran règles -->
      <div class="overlay" id="rules">
        <div class="box">
          <h1>MLE Runner</h1>
          <p>
            • Appuie sur <strong>Espace</strong> ou touche l’écran pour sauter.<br>
            • Évite les obstacles au sol et dans les airs.<br>
            • Le jeu est infini et devient de plus en plus difficile.<br>
            • En cas de défaite, réponds à une question professionnelle pour continuer.
          </p>
          <button onclick="startGame()">Démarrer le jeu</button>
        </div>
      </div>

      <!-- Écran question -->
      <div class="overlay" id="quiz" style="display:none">
        <div class="box">
          <h1>Question professionnelle</h1>
          <p id="question"></p>
          <div class="answers" id="answers"></div>
        </div>
      </div>
    </div>
  </div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let running = false;
let score = 0;
let level = 1;
let speed = 4;

const player = {
  x: 80,
  y: 300,
  r: 22,
  vy: 0,
  jump(){ if(this.y >= 300){ this.vy = -12; } }
};

let obstacles = [];

const words = ["Mission Locale","Emploi","Formation","CV","Orientation","Insertion","Projet Pro","Compétences","Stage","Alternance"];

const questions = [
[
  { q:"Que faut-il absolument mettre en haut d'un CV ?", a:["Nom et contact","Recette de cuisine","Photo uniquement"], correct:0, points:50 },
  { q:"Quelle durée idéale pour un CV ciblé ?", a:["1 page","5 pages","10 pages"], correct:0, points:40 },
  { q:"Que signifie \"soft skill\" ?", a:["Compétence comportementale","Logiciel","Diplôme"], correct:0, points:30 },
  { q:"Que faire après une candidature ?", a:["Relancer poliment","Ne rien faire","Envoyer tous les jours"], correct:0, points:30 },
  { q:"En entretien, comment commencer ?", a:["Bonjour + présentation brève","Raconter sa vie privée","Faire un sketch"], correct:0, points:40 },
  { q:"Quelle est une bonne qualité professionnelle ?", a:["Ponctualité","Arriver en retard","Manque de respect"], correct:0, points:30 },
  { q:"Comment adapter son CV à une offre ?", a:["Mettre en avant les compétences demandées","Envoyer le même CV","Changer juste la police"], correct:0, points:35 },
  { q:"Qu'est-ce qu'une lettre de motivation ?", a:["Un texte adapté à l'offre","Un CV plus long","Une liste de notes personnelles"], correct:0, points:25 },
  { q:"Où trouver des offres ?", a:["Sites d'emploi","Sur la Lune"], correct:0, points:20 },
  { q:"Quel comportement éviter en entretien ?", a:["Regarder son téléphone","Écouter le recruteur","Demander des précisions"], correct:0, points:30 },
  { q:"Qu'est-ce qu'un \"stage\" ?", a:["Une période d'apprentissage en entreprise","Un travail permanent","Un abonnement"], correct:0, points:20 },
  { q:"Pourquoi relancer une candidature ?", a:["Montrer son intérêt","Manquer d'organisation","Crier"], correct:0, points:25 },
  { q:"Comment se présenter ?", a:["Nom + objectif professionnel bref","Raconter un long épisode","Chanter"], correct:0, points:30 },
  { q:"Qu'est-ce qu'un bon CV ?", a:["Clairement structuré","Brouillon","Sans contact"], correct:0, points:35 },
  { q:"Quelle information NE doit PAS figurer ?", a:["Informations médicales sensibles","Compétences","Contact"], correct:0, points:30 },
  { q:"Que signifie \"références\" dans un CV ?", a:["Personnes pouvant témoigner de vous","Des références bibliographiques","Un mystère"], correct:0, points:20 },
  { q:"Qu'est-ce qu'une compétence transférable ?", a:["Capacité utile dans plusieurs emplois","Un seul logiciel","Un diplôme précis"], correct:0, points:30 },
  { q:"Que faire si on ne sait pas répondre en entretien ?", a:["Admettre et proposer comment trouver la réponse","Inventer une fausse réponse","Ignorer"], correct:0, points:40 },
  { q:"Quel ton adopter en entretien ?", a:["Professionnel et cordial","Hautain","Trop familier"], correct:0, points:30 },
  { q:"Comment montrer sa motivation ?", a:["Par des exemples concrets","Dire \"je suis motivé\" sans preuve","Ne rien faire"], correct:0, points:35 },
  { q:"Qu'est-ce qu'une lettre d'accompagnement ?", a:["Un texte pour contextualiser le CV","Un CV détourné","Un document inutile"], correct:0, points:25 },
  { q:"Pourquoi soigner son profil en ligne ?", a:["Les recruteurs regardent souvent","Personne ne regarde","C'est interdit"], correct:0, points:25 },
  { q:"Citer une soft skill importante ?", a:["Capacité d'écoute","Savoir tout faire","Ignorance"], correct:0, points:20 },
  { q:"Que faire en cas de retard ?", a:["Prévenir et s'excuser","Rester silencieux","Ignorer"], correct:0, points:20 },
  { q:"Quelle information est utile pour un recruteur ?", a:["Expériences récentes et pertinentes","Vos secrets","Informations bancaires"], correct:0, points:30 },
  { q:"Qu'est-ce que la ponctualité ?", a:["Arriver à l'heure","Arriver quand on veut","Partir tôt"], correct:0, points:15 },
  { q:"Pourquoi personnaliser sa candidature ?", a:["Montrer l'adéquation avec l'offre","Gagner du temps","Faire n'importe quoi"], correct:0, points:25 },
  { q:"Que faire avec un trou dans le CV ?", a:["Expliquer brièvement en valorisant","Tout cacher","Mentir"], correct:0, points:20 },
  { q:"Quel document joindre ?", a:["CV + lettre adaptée","Rien","Tout ce qu'on a"], correct:0, points:20 },
  { q:"Où demander de l'aide ?", a:["Mission Locale / Pôle emploi / réseau","Personne","La rue"], correct:0, points:20 },
  { q:"Comment se former ?", a:["Par des formations, des MOOC, des stages","Rien","Regarder la télé"], correct:0, points:25 },
  { q:"Que montre une bonne attitude ?", a:["Curiosité et respect","Arrogance","Indifférence"], correct:0, points:30 },
  { q:"Pourquoi relire son CV ?", a:["Éviter les fautes et les incohérences","Pour le style fantaisiste","Pour l'oublier"], correct:0, points:20 },
  { q:"Que signifie \"candidature spontanée\" ?", a:["Envoyer son CV sans offre précise","Attendre une offre","Appeler en criant"], correct:0, points:25 },
  { q:"Comment préparer un entretien ?", a:["Se renseigner sur l'entreprise","Y aller sans préparation","Ignorer l'entreprise"], correct:0, points:30 },
  { q:"Quel est l'objectif d'une lettre ?", a:["Montrer l'adéquation avec l'offre","Remplir un espace","Raconter sa vie"], correct:0, points:20 },
  { q:"Pourquoi valoriser un stage ?", a:["Montrer des compétences réelles","Le cacher","Ne rien dire"], correct:0, points:20 },
  { q:"Qu'est-ce qu'une alternance ?", a:["Formation en entreprise + école","Vacances prolongées","Un emploi permanent"], correct:0, points:20 },
  { q:"Que faire après un entretien ?", a:["Remercier et relancer si besoin","Tout oublier","Attendre une semaine sans rien faire"], correct:0, points:20 },
  { q:"Quel est un bon comportement en équipe ?", a:["Partager l'information","Tout garder pour soi","S'opposer systématiquement"], correct:0, points:30 },
  { q:"Pourquoi être honnête ?", a:["La confiance facilite l'embauche","On ne sait pas","C'est inutile"], correct:0, points:30 },
  { q:"Que chercher dans une offre ?", a:["Mots-clés, compétences et missions","Juste le salaire","Rien"], correct:0, points:25 },
  { q:"Que fait un conseiller Mission Locale ?", a:["Aide, orientation, formations","Rien","Décore des bureaux"], correct:0, points:20 }
]

function startGame(){
  document.getElementById('rules').style.display='none';
  reset();
  running = true;
}

function reset(){
  score = 0;
  level = 1;
  speed = 4;
  obstacles = [];
}

function addObstacle(){
  const air = level >= 5 && Math.random() < 0.3;
  obstacles.push({
    x: canvas.width + 20,
    y: air ? 240 : 320,
    w: 30,
    h: air ? 30 : 50,
    air
  });
}

function update(){
  if(!running) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Décor mots
  ctx.fillStyle = "rgba(30,136,229,0.08)";
  words.forEach((w,i)=>{
    ctx.fillText(w, (i*200 - (score*0.5)%200), 80 + (i%3)*80);
  });

  // Joueur
  player.vy += 0.6;
  player.y += player.vy;
  if(player.y > 300){ player.y = 300; player.vy = 0; }

  ctx.beginPath();
  ctx.arc(player.x, player.y, player.r, 0, Math.PI*2);
  ctx.fillStyle = 'var(--orange)';
  ctx.fill();
  ctx.lineWidth = 4;
  ctx.strokeStyle = 'var(--bleu)';
  ctx.stroke();
  ctx.fillStyle = '#000';
  ctx.font = '12px Arial';
  ctx.textAlign='center';
  ctx.fillText('MLE', player.x, player.y+4);

  // Obstacles
  obstacles.forEach(o=>{
    o.x -= speed;
    ctx.fillStyle = o.air ? 'var(--rouge)' : 'var(--jaune)';
    ctx.fillRect(o.x,o.y,o.w,o.h);

    // Collision
    const dx = Math.max(o.x - player.x, 0, player.x - (o.x + o.w));
    const dy = Math.max(o.y - player.y, 0, player.y - (o.y + o.h));
    if(dx*dx + dy*dy < player.r*player.r){ lose(); }
  });

  obstacles = obstacles.filter(o=>o.x+o.w>0);

  if(Math.random() < 0.02) addObstacle();

  score++;
  if(score % 500 === 0){ level++; speed+=0.5; }

  document.getElementById('score').innerText = `Score : ${score} | Niveau : ${level}`;

  requestAnimationFrame(update);
}

function lose(){
  running = false;
  showQuiz();
}

function showQuiz(){
  const q = questions[Math.floor(Math.random()*questions.length)];
  document.getElementById('quiz').style.display='flex';
  document.getElementById('question').innerText = q.q;
  const answers = document.getElementById('answers');
  answers.innerHTML='';
  q.a.forEach((txt,i)=>{
    const b = document.createElement('button');
    b.innerText = txt;
    b.onclick=()=>{
      document.getElementById('quiz').style.display='none';
      if(i===q.c){ running=true; requestAnimationFrame(update); }
      else{ reset(); running=true; requestAnimationFrame(update); }
    }
    answers.appendChild(b);
  });
}

window.addEventListener('keydown',e=>{ if(e.code==='Space') player.jump(); });
canvas.addEventListener('touchstart',()=>player.jump());

requestAnimationFrame(update);
</script>
</body>
</html>
